connections:
  - name: "conn1"
    dsn: "{{db_dsn}}"
queries:
  - connection: "conn1"
    type: "exec"
    message_before: "prepare table"
    sql: "DROP TABLE IF EXISTS users"
  - connection: "conn1"
    type: "exec"
    message_before: "prepare table"
    sql: "CREATE TABLE `users` (ts timestamp, dt datetime) ENGINE=InnoDB"
  - connection: "conn1"
    type: "exec"
    sql: "set time_zone = '+00:00';"
    message_before: "set utc timezone"
  - connection: "conn1"
    type: "query"
    message_before: "check current ts of server"
    sql: "SELECT TIMEDIFF(NOW(), UTC_TIMESTAMP);"
  - connection: "conn1"
    type: "exec"
    sql: "insert into users(ts, dt) values('2018-01-01 10:00:00', '2018-01-01 10:00:00')"
    message_before: "insert some date"
  - connection: "conn1"
    type: "query"
    sql: "select * from users"
    message_after: "we see equal values, that insert"
  - connection: "conn1"
    type: "exec"
    sql: "set time_zone = '+01:00';"
    message_before: "set other timezone for connection"
  - connection: "conn1"
    type: "query"
    sql: "select * from users"
    message_before: "timestamp store utc timestamp and convert it to timezone of connection, datetime not convert anything"
    message_after: "value of timestamp changed, value of datetime don't change"
